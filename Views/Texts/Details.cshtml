@using System.Security.Claims;
@model info_2022.Models.ViewModels.TextWithOpinions

@{
    ViewData["Title"] = @Model.SelectedText.Title;
}

<article>
    <h1 class="oswald text-primary text-center">@Model.SelectedText.Title</h1>
    <div class="row">
    <section class="col-lg-3 mt-3">
        <div class="row">
            <div class="col-6 col-lg-12">
                <h6><i class="bi bi-person-circle me-1"></i><span class="text-success fw-bold">@Model.SelectedText.User.FullName</span></h6>
                <h6><i class="bi bi-calendar-event me-1"></i>@Model.SelectedText.AddedDate.ToString("dd MMMM yyyy")</h6>
                <h6><i class="bi bi-folder2-open me-1"></i>@Model.SelectedText.Category.Name</h6>
            </div>
            <div class="col-6 col-lg-12">
                <h6><i class="bi bi-smartwatch me-1"></i>Czas czytania ok. @Model.ReadingTime min</h6>
                <h6><i class="bi bi-chat-square-text me-1"></i>@Model.CommentsNumber @Model.Description</h6>
                    <h6><i class="bi bi bi-trophy me-1"></i><star-rating rating-avg=@Model.AverageScore rating-count=@Model.OpinionsNumber></star-rating> 
                        @if (@Model.OpinionsNumber > 0)
                        {
                            <small class="text-secondary">(@Model.AverageScore z @Model.OpinionsNumber)</small>
                        }
                        </h6>
                </div>
        </div>
            @{
                string[] tags = @Model.SelectedText.Keywords.Split(',');
                foreach (var tag in tags)
                {
                    <h6 class="d-inline d-lg-block"><span class="badge bg-primary">@tag</span></h6>
                }
            }
    </section>
    <section class="col-lg-9">
            @{
                if (!String.IsNullOrEmpty(Model.SelectedText.Graphic))
                {
                    <img class="img-fluid mt-3" src="~/img/@Model.SelectedText.Graphic">
                }
                else
                {
                    <hr />
                }
            }

            <div class="col-10 offset-1 my-3">
                <h6 class="lead fst-italic">@Model.SelectedText.Summary</h6>
            </div>
            <hr />
            @Html.Raw(Model.SelectedText.Content)
            <hr />
    </section>
    </div>
</article>
<div class="col-lg-9 offset-lg-3"
    <section>
        <a asp-action="Index" class="btn btn-primary">Lista tekstów</a>
        @if (User.FindFirstValue(ClaimTypes.NameIdentifier) == Model.SelectedText.Id)
        {
            <a asp-action="Edit" asp-route-id="@Model?.SelectedText.TextId" class="btn btn-warning">Edycja tekstu</a>
        }
    </section>
</div>
